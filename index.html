<style>
	html,
	body {
		background: #000;
		font-family: consolas, monospace;
		color: white;
		margin: 0px;
		width: 100%;
		height: 100%;
		cursor: default;
		overflow-x: auto;
		/* Enable horizontal scrolling */
		word-wrap: break-word;
		/* Break words to the next line */
	}

	body {
		overflow: hidden scroll;
	}

	#log div {
		width: 100%;
	}

	#prompt {
		position: absolute;
		box-sizing: content-box;
		z-index: 2;
	}

	#input {
		position: absolute;
		box-sizing: border-box;
		background: transparent;
		border: 0px;
		padding: 0px 0px 0px var(--prompt-offset);
		color: inherit;
		font: inherit;
		outline: none;
		width: 100%;
		cursor: inherit;
		z-index: 1;
	}

	::selection {
		background: #aaa;
	}
</style>

<body onclick="input.focus()">
	<div id="log"></div>
	<form spellcheck="false" autocomplete="off" action="javascript:runCmd(input.value,true,true)">
		<div>
			<div id="prompt"></div>
			<input id="input" autofocus>
		</div>
	</form>
</body>
<script src="Script/Variables.js"></script>
<script src="Script/Commands.js"></script>
<script src="Script/Packages.js"></script>
<script>
	
	function echo(text) {
		if (text && removeIndent(text)) {
			switch (removeIndent(text)) {
				case "on":
				case "off":
					echoState = text;
					echo();
					break;
				default:
					var div = document.createElement("div");
					div.innerText = text || "\n";
					log.appendChild(div);
			}
		} else {
			echo(`ECHO command is ${echoState}.`);
		}
	}
	function resetPrompt() {
		if (promptState == "default") prompt = pathToString() + "";
		promptElement.innerText = prompt;
		document.body.style.setProperty("--prompt-offset", promptElement.clientWidth + "px");
	}

	function toSpaces(array) {
		if (array) {
			var string = "";
			array.forEach((el, i) => {
				string += el;
				if (i + 1 < array.length) string += " ";
			});
			return string;
		}
	}
	function removeIndent(string) {
		var text = string;
		if (text) {
			while (text[0] == " " || text[0] == "	") text = text.slice(1, text.length);
			while (text[text.length - 1] == " " || text[text.length - 1] == "	") text.pop();
		}
		return text;
	}

	input.onkeydown = function (key) {
		switch (key.keyCode) {
			case 38:
				if (memory.length) {
					if (memoryPos > 0 && navigatingInMemory) memoryPos--;
					input.value = memory[memoryPos];
					input.selectionStart = memory[memoryPos].length;
					input.selectionEnd = memory[memoryPos].length;
					navigatingInMemory = true;
				}
				break;
			case 40:
				if (memory.length) {
					if (memoryPos < memory.length && navigatingInMemory) memoryPos++;
					if (memoryPos >= memory.length) memoryPos = memory.length - 1;
					input.value = memory[memoryPos];
					input.selectionStart = memory[memoryPos].length;
					input.selectionEnd = memory[memoryPos].length;
					navigatingInMemory = true;
				}
		}
	}

	function cmd() {
		runCmd("ver");
		echo("\n");
		resetPrompt();
	}

	cmd();

	function loop() {
		//
	}
	setInterval(() => {
		loop();
	}, 1);

</script>